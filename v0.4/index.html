<!DOCTYPE HTML>
<html>

<!--
    Anthony Giorgio
    Marist College
    CMPT 120
    July 1, 2016
    Introduction to Programming
    Project 3 - Game v0.4
-->
<head>
<title>JavaScript Adventure</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="author" content="Anthony Giorgio" />

<style>
.footer {
	font-style: italic;
}

.name {
	color: red;
	font-size: 20px;
}

.game {
	color: violet;
	font-size: 28px;
}
</style>
<script type="text/javascript">
	/* Array indices */
	var BAD = -1;
	var NORTH = 0;
	var SOUTH = 1;
	var EAST = 2;
	var WEST = 3;

	var NORTH_CMD = "n";
	var SOUTH_CMD = "s";
	var EAST_CMD = "e";
	var WEST_CMD = "w";

	//Location prototype
	function Location(_id, _name, _description) {
		//Attributes
		this.id = _id;
		this.name = _name;
		this.description = _description;
		/* N, S, E, W */
		this.validMoves;
		this.visited = false;

		this.toString = function() {
			var message = "Location: " + this.name + "\n\n" + this.description;
			return (message);
		}

		this.visit = function() {
			if (this.visited === false) {
				this.visited = true;
				score += 5;
			}
		}
	}

	var northPole = new Location(0, "North Pole", "Brrr!  It's cold here!");
	var theSouth = new Location(1, "The South", "Welcome, y'all");
	var outWest = new Location(2, "Out West", "Go west, young man.");
	var eastCoast = new Location(3, "East Coast",
			"You can see the Atlantic Ocean.");
	var forest = new Location(4, "Forest", "The trees are dark and spooky here");
	var desert = new Location(5, "Desert", "It's hot and dry here");

	var locations = [ northPole, theSouth, outWest, eastCoast, forest, desert ];
	var score = 0;
	var position = forest.id;

	northPole.validMoves = [ BAD, forest.id, BAD, BAD ];
	theSouth.validMoves = [ desert.id, BAD, BAD, BAD ];
	outWest.validMoves = [ BAD, BAD, desert.id, BAD ];
	eastCoast.validMoves = [ BAD, BAD, BAD, desert.id ];
	forest.validMoves = [ northPole.id, desert.id, BAD, BAD ];
	desert.validMoves = [ forest.id, theSouth.id, eastCoast.id, outWest.id ];

	/* Build a invalid move error message */
	function badMove(_validMoves) {
		var message = "Invalid move.\n\nValid moves are: ";

		if (_validMoves[NORTH] !== BAD) {
			message += NORTH_CMD + " ";
		}
		if (_validMoves[SOUTH] !== BAD) {
			message += SOUTH_CMD + " ";
		}
		if (_validMoves[EAST] !== BAD) {
			message += EAST_CMD + " ";
		}
		if (_validMoves[WEST] !== BAD) {
			message += WEST_CMD + " ";
		}

		return message;
	}

	function navigate(_direction) {

		var message;

		switch (_direction) {
		case NORTH_CMD:
			if (locations[position].validMoves[NORTH] === BAD) {
				message = badMove(locations[position].validMoves);
			} else {
				/* Move to the new location */
				position = locations[position].validMoves[NORTH];
				locations[position].visit();
				message = locations[position].toString();
			}
			break;

		case SOUTH_CMD:
			if (locations[position].validMoves[SOUTH] === BAD) {
				message = badMove(locations[position].validMoves);
			} else {
				/* Move to the new location */
				position = locations[position].validMoves[SOUTH];
				locations[position].visit();
				message = locations[position].toString();
			}
			break;

		case EAST_CMD:
			if (locations[position].validMoves[EAST] === BAD) {
				message = badMove(locations[position].validMoves);
			} else {
				/* Move to the new location */
				position = locations[position].validMoves[EAST];
				locations[position].visit();
				message = locations[position].toString();
			}
			break;

		case WEST_CMD:
			if (locations[position].validMoves[WEST] === BAD) {
				message = badMove(locations[position].validMoves);
			} else {
				/* Move to the new location */
				position = locations[position].validMoves[WEST];
				locations[position].visit();
				message = locations[position].toString();
			}
			break;

		default:
			message = "Bad navigation direction: " + _direction;
			break;
		}

		displayMessage(message);
		updateScore();
	}

	function btnNorth_click() {
		navigate(NORTH_CMD);
	}

	function btnSouth_click() {
		navigate(SOUTH_CMD);
	}

	function btnEast_click() {
		navigate(EAST_CMD);
	}

	function btnWest_click() {
		navigate(WEST_CMD);
	}

	function displayMessage(_message) {
		var textarea = document.getElementById("textarea");
		textarea.value = _message;
	}

	function updateScore() {
		var scoreArea = document.getElementById("score");
		scoreArea.textContent = "Score: " + score;
	}

	function btnCommand() {
		var textArea = document.getElementById("textarea");
		var commandBox = document.getElementById("commandBox");
		var command = commandBox.value.toLowerCase();

		/* Clear the command input box */
		commandBox.value = "";

		switch (command) {
		case NORTH_CMD:
		case SOUTH_CMD:
		case EAST_CMD:
		case WEST_CMD:
			navigate(command);
			break;
		default:
			textArea.value = "Unknown command.\n\n"
					+ "Valid commands are n, s, e, w.";
			break;
		}

	}
</script>
</head>

<body>
	<p class="name">
		<a href="mailto:Anthony.Giorgio@marist.edu">Anthony Giorgio</a>
	</p>
	<p class="game">JavaScript Adventure</p>

	<textarea rows="8" cols="40" id="textarea" readonly>You are standing in a field, west of a house. There is a mailbox here.</textarea>

	<p id="score">Score: 0</p>

	<p>
		Command:
		<textarea rows="1" cols="20" id="commandBox"></textarea>
		<input type="button" id="btnCommand" name="btnCommand" value="Go"
			onclick="btnCommand();" />
	</p>

	<input type="button" id="btnNorth" name="btnNorth" value="North"
		onclick="btnNorth_click();" />

	<input type="button" id="btnSouth" name="btnSouth" value="South"
		onclick="btnSouth_click();" />

	<input type="button" id="btnEast" name="btnEast" value="East"
		onclick="btnEast_click();" />

	<input type="button" id="btnWest" name="btnWest" value="West"
		onclick="btnWest_click();" />

	<p class="footer">
		<a href="http://validator.w3.org/#validate_by_input">Validate as
			HTML5</a>
	</p>
</body>

</html>
